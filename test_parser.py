#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
測試 handle_time2025.py 中的 parser_date_time 函數
準備100句自然語言測試句，包含預約與非預約情境
"""

import sys
import os
sys.path.append(os.path.dirname(os.path.abspath(__file__)))
sys.path.append(os.path.join(os.path.dirname(os.path.abspath(__file__)), 'ai_parser'))

from handle_time2025 import parser_date_time

# 測試句子列表 - 涵蓋各種日期、時間、預約/非預約情境
test_sentences = [
    # 基本預約句子 (1-20)
    "我想預約明天上午10點",
    "幫我訂今天下午3點的位子",
    "後天中午12點可以預約嗎",
    "預約下星期一早上9點",
    "我想訂明天晚上7點",
    "幫我安排今天中午12點的會議",
    "預約後天上午11點半",
    "下星期二下午2點可以嗎",
    "我想訂今天晚上8點",
    "幫我預約明天早上8點",
    "預約下星期三中午12點",
    "今天下午4點訂位",
    "明天上午9點半預約",
    "後天晚上6點",
    "下星期四上午10點",
    "今天中午1點",
    "明天下午3點半",
    "後天早上7點",
    "下星期五晚上8點",
    "今天上午11點",

    # 中文時間表達 (21-40)
    "預約明天三點",
    "幫我訂後天一點半",
    "下星期一兩點",
    "明天五點半",
    "後天四點",
    "下星期二六點半",
    "明天七點",
    "後天八點半",
    "下星期三九點",
    "明天十點半",
    "後天十一點",
    "下星期四十二點半",
    "明天一點",
    "後天兩點半",
    "下星期五三點",
    "明天四點半",
    "後天五點",
    "下星期六六點半",
    "明天七點",
    "後天八點半",

    # 相對日期表達 (41-60)
    "預約昨天上午10點",  # 過去時間
    "幫我訂前天下午3點",  # 過去時間
    "大前天中午12點",  # 過去時間
    "大後天早上9點",
    "本日晚上7點",
    "昨日上午11點",  # 過去時間
    "今兒下午2點",
    "明兒早上8點",
    "後日中午1點",
    "近日內下午4點",
    "馬上預約",
    "立刻訂位",
    "現在下午5點",
    "等下上午10點",
    "等一下中午12點",
    "本天晚上6點",
    "這天上午9點",
    "今日下午3點",
    "明日早上7點",
    "後日晚上8點",

    # 星期表達 (61-80)
    "預約下星期一上午10點",
    "下星期二下午2點",
    "上星期三中午12點",  # 過去時間
    "下下星期四早上9點",
    "本星期五晚上7點",
    "下星期六上午11點",
    "上星期日中午1點",  # 過去時間
    "下下星期一下午3點",
    "本星期二晚上6點",
    "下星期三上午8點",
    "上星期四中午12點",  # 過去時間
    "下下星期五下午4點",
    "本星期六早上10點",
    "下星期日晚上9點",
    "上星期一上午11點",  # 過去時間
    "下下星期二中午2點",
    "本星期三下午5點",
    "下星期四早上7點",
    "上星期五晚上8點",  # 過去時間
    "下下星期六上午9點",

    # 具體日期與時間 (81-100)
    "預約2025年12月15日早上9點",
    "2025-12-16下午3點",
    "12月17日中午12點",
    "2025/12/18晚上7點",
    "明年1月1日早上8點",
    "去年12月25日中午1點",  # 過去時間
    "今年春節上午10點",
    "明年中秋節晚上6點",
    "後年國慶節下午2點",
    "今年五一勞動節中午12點",
    "明年端午節早上9點",
    "去年重陽節下午4點",  # 過去時間
    "今年教師節上午11點",
    "後年元旦晚上8點",
    "明年七夕節中午1點",
    "去年兒童節下午3點",  # 過去時間
    "今年植樹節早上7點",
    "後年婦女節晚上5點",
    "明年聖誕節上午10點",
    "去年萬聖節中午2點"  # 過去時間
]

def run_tests():
    """執行測試並輸出結果"""
    print("開始測試 parser_date_time 函數...")
    print("=" * 80)

    results = []
    for i, sentence in enumerate(test_sentences, 1):
        try:
            result = parser_date_time(sentence, time_format_type=2)  # 預設 hh:mm
            results.append((i, sentence, result))
            print(f"{i:2d}. {sentence} -> {result}")
        except Exception as e:
            results.append((i, sentence, f"錯誤: {str(e)}"))
            print(f"{i:2d}. {sentence} -> 錯誤: {str(e)}")

    print("\n" + "=" * 80)
    print("測試完成！總共測試了 {} 句".format(len(test_sentences)))

    # 統計結果
    success_count = sum(1 for _, _, result in results if isinstance(result, tuple) or not str(result).startswith("錯誤"))
    error_count = len(results) - success_count

    print(f"成功解析: {success_count}")
    print(f"解析錯誤: {error_count}")

    return results

if __name__ == "__main__":
    run_tests()
